{"timestamp":"2026-02-04T14:34:01.200036Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-04T14:34:01.207917Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-04T14:34:03.025630Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-04T14:34:03.166133Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:34:03.492868Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"UndefinedTable","exc_value":"relation \"accounts\" does not exist\nLINE 2:                 INSERT INTO accounts (id, customer_id, accou...\n                                    ^\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":103,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-04T14:42:31.897891Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-04T14:42:31.905655Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-04T14:42:34.005307Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-04T14:42:34.229756Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:42:34.333314Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"ForeignKeyViolation","exc_value":"insert or update on table \"accounts\" violates foreign key constraint \"accounts_customer_id_fkey\"\nDETAIL:  Key (customer_id)=(1) is not present in table \"customers\".\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":103,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-04T14:56:22.877723Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-04T14:56:22.878603Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-04T14:56:24.176447Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-04T14:56:24.261998Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.315386Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.316042Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.331495Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.331848Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.341356Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.341661Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-04T14:56:24.349982Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":105,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-04T15:04:41.690640Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-04T15:04:41.693432Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-04T15:04:43.765382Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-04T15:04:43.899339Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.036319Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.036988Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.076721Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.077943Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.114556Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.115579Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:04:44.134981Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":105,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-04T15:12:41.483002Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-04T15:12:41.484395Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-04T15:12:42.299332Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-04T15:12:42.369177Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.416270Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.416410Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.427719Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.428053Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.436597Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.437003Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-04T15:12:42.448143Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":110,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":105,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:17:18.698069Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:17:18.701654Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:17:19.986052Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:17:20.070456Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:17:20.112331Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table customers: duplicate key value violates unique constraint \"customers_pkey\"\nDETAIL:  Key (id)=(1) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":131,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"customers_pkey\"\nDETAIL:  Key (id)=(1) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":123,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:18:53.840058Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:18:53.841998Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:18:55.014350Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:18:55.135198Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.191922Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.192048Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.213363Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.213507Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.222339Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.222601Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.228774Z","level":"info","event":"❌ FAILED ROW INDEX: 0","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.229103Z","level":"info","event":"❌ FAILED ROW DATA:","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.229301Z","level":"info","event":"   id: 1 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.229477Z","level":"info","event":"   account_id: 3 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.229653Z","level":"info","event":"   txn_type: WITHDRAWAL (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.229818Z","level":"info","event":"   amount: 906.91 (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.230184Z","level":"info","event":"   related_account_id: nan (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.230382Z","level":"info","event":"   status: COMPLETED (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.230527Z","level":"info","event":"   created_at: 2026-02-04T11:38:10.693246Z (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:18:55.228751Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":131,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":108,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:25:40.058717Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:25:40.059776Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:25:40.975483Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:25:41.071859Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.124872Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.125060Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.139185Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.139386Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.146720Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.147001Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.162910Z","level":"info","event":"❌ FAILED ROW INDEX: 0","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.163494Z","level":"info","event":"❌ FAILED ROW DATA:","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.163846Z","level":"info","event":"   id: 1 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.164164Z","level":"info","event":"   account_id: 3 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.164508Z","level":"info","event":"   txn_type: WITHDRAWAL (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.164998Z","level":"info","event":"   amount: 906.91 (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.165297Z","level":"info","event":"   related_account_id: nan (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.165692Z","level":"info","event":"   status: COMPLETED (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.166658Z","level":"info","event":"   created_at: 2026-02-04T11:38:10.693246Z (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:25:41.166346Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":133,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":110,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:28:41.364942Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:28:41.366317Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:28:42.106694Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:28:42.405005Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:28:42.468479Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table customers: duplicate key value violates unique constraint \"customers_pkey\"\nDETAIL:  Key (id)=(1) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":133,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"UniqueViolation","exc_value":"duplicate key value violates unique constraint \"customers_pkey\"\nDETAIL:  Key (id)=(1) already exists.\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":125,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:29:38.556786Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:29:38.559387Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:29:39.665191Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:29:39.728091Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.768402Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.768543Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.782822Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.782991Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.790191Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.790320Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.802161Z","level":"info","event":"❌ FAILED ROW INDEX: 0","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.802912Z","level":"info","event":"❌ FAILED ROW DATA:","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.802980Z","level":"info","event":"   id: 1 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803030Z","level":"info","event":"   account_id: 3 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803081Z","level":"info","event":"   txn_type: WITHDRAWAL (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803124Z","level":"info","event":"   amount: 906.91 (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803169Z","level":"info","event":"   related_account_id: nan (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803243Z","level":"info","event":"   status: COMPLETED (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.803290Z","level":"info","event":"   created_at: 2026-02-04T11:38:10.693246Z (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:29:39.798356Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":133,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"NumericValueOutOfRange","exc_value":"integer out of range\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":110,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:34:36.665257Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:34:36.666427Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:34:37.749537Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:34:37.830111Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:34:37.930044Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"KeyError","exc_value":"'related_account_id'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":94,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/frame.py","lineno":3893,"name":"__getitem__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py","lineno":3798,"name":"get_loc"}],"is_group":false,"exceptions":[]},{"exc_type":"KeyError","exc_value":"'related_account_id'","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/indexes/base.py","lineno":3791,"name":"get_loc"},{"filename":"/opt/airflow/index.pyx","lineno":152,"name":"pandas._libs.index.IndexEngine.get_loc"},{"filename":"/opt/airflow/index.pyx","lineno":181,"name":"pandas._libs.index.IndexEngine.get_loc"},{"filename":"/opt/airflow/pandas/_libs/hashtable_class_helper.pxi","lineno":7080,"name":"pandas._libs.hashtable.PyObjectHashTable.get_item"},{"filename":"/opt/airflow/pandas/_libs/hashtable_class_helper.pxi","lineno":7088,"name":"pandas._libs.hashtable.PyObjectHashTable.get_item"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:52:01.141565Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:52:01.146475Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:52:02.183991Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:52:02.274718Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.318084Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.318526Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.334825Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.334965Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.345050Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.345188Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358291Z","level":"info","event":"❌ FAILED ROW INDEX: 0","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358498Z","level":"info","event":"❌ FAILED ROW DATA:","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358557Z","level":"info","event":"   id: 1 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358607Z","level":"info","event":"   account_id: 3 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358654Z","level":"info","event":"   txn_type: WITHDRAWAL (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358708Z","level":"info","event":"   amount: 906.91 (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358759Z","level":"info","event":"   related_account_id: <NA> (<class 'pandas._libs.missing.NAType'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358809Z","level":"info","event":"   status: COMPLETED (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358908Z","level":"info","event":"   created_at: 2026-02-04T11:38:10.693246Z (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:52:02.358353Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: can't adapt type 'NAType'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":139,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"ProgrammingError","exc_value":"can't adapt type 'NAType'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":116,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1267,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T08:58:50.625306Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T08:58:50.626751Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T08:58:51.637834Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T08:58:51.714029Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.799675Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.799888Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.821337Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.821710Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.830276Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.830495Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844472Z","level":"info","event":"❌ FAILED ROW INDEX: 7","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844699Z","level":"info","event":"❌ FAILED ROW DATA:","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844740Z","level":"info","event":"   id: 8 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844775Z","level":"info","event":"   account_id: 19 (<class 'int'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844806Z","level":"info","event":"   txn_type: TRANSFER (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844836Z","level":"info","event":"   amount: 750.81 (<class 'float'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844869Z","level":"info","event":"   related_account_id: 16 (<class 'numpy.int64'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844901Z","level":"info","event":"   status: COMPLETED (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844932Z","level":"info","event":"   created_at: 2026-02-04T11:38:10.708944Z (<class 'str'>)","logger":"task.stdout"}
{"timestamp":"2026-02-05T08:58:51.844664Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed loading table transactions: can't adapt type 'numpy.int64'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":141,"name":"load_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"ProgrammingError","exc_value":"can't adapt type 'numpy.int64'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":118,"name":"load_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1267,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T09:07:04.126103Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T09:07:04.128504Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T09:07:05.119632Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T09:07:05.230351Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.269857Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.270950Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.281728Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.281933Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.287644Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.287806Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.339044Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522950225.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.377611Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522983126.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.425770Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134523016211.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.459197Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134523055164.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:07:05.489492Z","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator","filename":"python.py","lineno":215}
{"timestamp":"2026-02-05T09:11:46.399429Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T09:11:46.400458Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_snowflake_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T09:11:47.545199Z","level":"warning","event":"The `airflow.operators.python.PythonOperator` attribute is deprecated. Please use `'airflow.providers.standard.operators.python.PythonOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/minio_to_snowflake_dag.py","lineno":6,"logger":"py.warnings"}
{"timestamp":"2026-02-05T09:11:47.645859Z","level":"info","event":"Loading /tmp/minio_downloads/customers_134522897738.parquet into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.712848Z","level":"info","event":"Inserted 50 rows into customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.713210Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522838920.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.737841Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.738266Z","level":"info","event":"Loading /tmp/minio_downloads/accounts_134522877562.parquet into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.749161Z","level":"info","event":"Inserted 50 rows into accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.749402Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522932329.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.764566Z","level":"info","event":"Inserted 50 rows into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.764849Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522950225.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.777376Z","level":"info","event":"Inserted 50 rows into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.777526Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134522983126.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.792730Z","level":"info","event":"Inserted 50 rows into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.792959Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134523016211.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.803375Z","level":"info","event":"Inserted 50 rows into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.803660Z","level":"info","event":"Loading /tmp/minio_downloads/transactions_134523055164.parquet into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.818569Z","level":"info","event":"Inserted 50 rows into transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T09:11:47.819260Z","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator","filename":"python.py","lineno":215}
{"timestamp":"2026-02-05T10:22:47.893193Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T10:22:47.894630Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_pgdw_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T10:22:49.970202Z","level":"info","event":"Inserted 50 rows into raw_accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:22:49.996993Z","level":"info","event":"Inserted 50 rows into raw_accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:22:50.029554Z","level":"info","event":"Inserted 50 rows into raw_customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:22:50.054133Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"RuntimeError","exc_value":"Failed inserting into raw_transactions: invalid input syntax for type json\nLINE 1: INSERT INTO raw_transactions (data) VALUES ('{\"id\": 1, \"acco...\n                                                    ^\nDETAIL:  Token \"NaN\" is invalid.\nCONTEXT:  JSON data, line 1: ...WAL\", \"amount\": 906.91, \"related_account_id\": NaN...\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/minio_to_pgdw_dag.py","lineno":204,"name":"load_raw_to_postgres"}],"is_group":false,"exceptions":[]},{"exc_type":"InvalidTextRepresentation","exc_value":"invalid input syntax for type json\nLINE 1: INSERT INTO raw_transactions (data) VALUES ('{\"id\": 1, \"acco...\n                                                    ^\nDETAIL:  Token \"NaN\" is invalid.\nCONTEXT:  JSON data, line 1: ...WAL\", \"amount\": 906.91, \"related_account_id\": NaN...\n","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/opt/airflow/dags/minio_to_pgdw_dag.py","lineno":199,"name":"load_raw_to_postgres"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/psycopg2/extras.py","lineno":1270,"name":"execute_values"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2026-02-05T10:31:25.282608Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2026-02-05T10:31:25.283964Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/minio_to_pgdw_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2026-02-05T10:31:26.715825Z","level":"info","event":"Inserted 50 rows into raw_accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.724440Z","level":"info","event":"Inserted 50 rows into raw_accounts","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.737850Z","level":"info","event":"Inserted 50 rows into raw_customers","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.751286Z","level":"info","event":"Inserted 50 rows into raw_transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.766854Z","level":"info","event":"Inserted 50 rows into raw_transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.780957Z","level":"info","event":"Inserted 50 rows into raw_transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.794168Z","level":"info","event":"Inserted 50 rows into raw_transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.807559Z","level":"info","event":"Inserted 50 rows into raw_transactions","logger":"task.stdout"}
{"timestamp":"2026-02-05T10:31:26.807850Z","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator","filename":"python.py","lineno":215}
